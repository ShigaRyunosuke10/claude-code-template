# Case A: æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ©Ÿèƒ½æ‹¡å¼µãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«æ–°æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹éš›ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé€£æºãƒ•ãƒ­ãƒ¼ã€‚

## Phase 0: è¦ä»¶ãƒ’ã‚¢ãƒªãƒ³ã‚°ï¼ˆãƒ¡ã‚¤ãƒ³Claude Agentæ‹…å½“ï¼‰

**é‡è¦**: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œã™ã‚‹å‰ã«ã€ã‚ãªãŸï¼ˆãƒ¡ã‚¤ãƒ³Claude Agentï¼‰ãŒä»¥ä¸‹ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è³ªå•ã—ã¦ãã ã•ã„ã€‚

### è¦ä»¶ãƒ’ã‚¢ãƒªãƒ³ã‚°é …ç›®

1. **è¿½åŠ ã—ãŸã„æ©Ÿèƒ½ã¯ä½•ã§ã™ã‹ï¼Ÿ**ï¼ˆå…·ä½“çš„ã«ï¼‰
2. **æƒ³å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯èª°ã§ã™ã‹ï¼Ÿ**ï¼ˆç®¡ç†è€…/ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼/etc.ï¼‰
3. **æ—¢å­˜æ©Ÿèƒ½ã¨ã®é–¢é€£ã¯ï¼Ÿ**ï¼ˆç‹¬ç«‹/æ—¢å­˜æ©Ÿèƒ½æ‹¡å¼µï¼‰
4. **å„ªå…ˆåº¦ã¯ï¼Ÿ**ï¼ˆé«˜/ä¸­/ä½ï¼‰
5. **æœŸé™ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ**

### å›ç­”ä¾‹
```
1. æ©Ÿèƒ½: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ç®¡ç†æ©Ÿèƒ½ï¼ˆç®¡ç†è€…ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å½¹å‰²ã‚’å‰²ã‚Šå½“ã¦ã‚‹ï¼‰
2. æƒ³å®šãƒ¦ãƒ¼ã‚¶ãƒ¼: ç®¡ç†è€…
3. æ—¢å­˜æ©Ÿèƒ½ã¨ã®é–¢é€£: æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã®æ‹¡å¼µ
4. å„ªå…ˆåº¦: é«˜
5. æœŸé™: 2é€±é–“å¾Œ
```

---

## Phase 1: è¦ä»¶å®šç¾©ãƒ»è¨ˆç”»ï¼ˆPlanningï¼‰

### 1.1 çµ±åˆè¨ˆç”»ï¼ˆEpic + ã‚¿ã‚¹ã‚¯åˆ†è§£ + APIå¥‘ç´„ï¼‰

**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: `planner`ï¼ˆæ—§ project-planner + sub-planner çµ±åˆï¼‰

```bash
Task:planner(prompt: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ç®¡ç†æ©Ÿèƒ½ã‚’è¿½åŠ ã—ãŸã„")
```

**å‡ºåŠ›**: `epic-user-role-management.md`
- Epicåˆ†è§£ï¼ˆ3-5å€‹ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ï¼‰
- å„ªå…ˆåº¦è¨­å®šãƒ»ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ç­–å®š
- ã‚¿ã‚¹ã‚¯ã”ã¨ã®DoD
- APIå¥‘ç´„ï¼ˆFE/BEï¼‰
- ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ—

**ä¾å­˜é–¢ä¿‚**: ãªã—

**stopæ¡ä»¶**: ã‚¿ã‚¹ã‚¯æ•° > 20ä»¶ã§è­¦å‘Šï¼ˆåˆ†å‰²æ¨å¥¨ï¼‰

---

## Phase 2: å®Ÿè£…ï¼ˆImplementationï¼‰

### 2.1 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…

**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: `impl-dev-backend`
**ä¾å­˜**: `sub-planner`å®Œäº†å¾Œ

```bash
Task:impl-dev-backend(prompt: "Task 1: usersãƒ†ãƒ¼ãƒ–ãƒ«ã«roleã‚«ãƒ©ãƒ è¿½åŠ ")
Task:impl-dev-backend(prompt: "Task 2: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«å–å¾—APIå®Ÿè£…")
```

**ç·¨é›†ã‚¹ã‚³ãƒ¼ãƒ—**: `backend/**`ã®ã¿
**å‡ºåŠ›**: 
- `backend/app/api/users.py` - ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- `backend/app/models.py` - ãƒ¢ãƒ‡ãƒ«æ›´æ–°
- `backend/tests/unit/test_users.py` - ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

**stopæ¡ä»¶**: pytestå¤±æ•— > 0ä»¶ã§åœæ­¢

### 2.2 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…

**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: `impl-dev-frontend`
**ä¾å­˜**: `impl-dev-backend`ã®APIå®Œæˆå¾Œ

```bash
Task:impl-dev-frontend(prompt: "Task 3: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«è¡¨ç¤ºUIå®Ÿè£…")
```

**ç·¨é›†ã‚¹ã‚³ãƒ¼ãƒ—**: `frontend/**`ã®ã¿
**å‡ºåŠ›**:
- `frontend/src/app/users/[id]/page.tsx` - ãƒšãƒ¼ã‚¸
- `frontend/src/lib/api/users.ts` - APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
- `frontend/src/components/RoleBadge.tsx` - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

**stopæ¡ä»¶**: ESLintã‚¨ãƒ©ãƒ¼ > 0ä»¶ã§åœæ­¢

### 2.3 FE/BEçµ±åˆãƒã‚§ãƒƒã‚¯

**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: `code-reviewer`ï¼ˆintegratoræ©Ÿèƒ½ã‚’çµ±åˆï¼‰
**ä¾å­˜**: `impl-dev-frontend` + `impl-dev-backend`å®Œäº†å¾Œ

```bash
Task:code-reviewer(prompt: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«APIã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ - FE/BEå‹å®šç¾©åŒæœŸç¢ºèª")
```

**å‡ºåŠ›**: `integration-report.md`
- APIå¥‘ç´„ä¸€è‡´ç¢ºèª
- å‹å®šç¾©åŒæœŸï¼ˆTypeScript â†” Pydanticï¼‰
- ä¸æ•´åˆä¿®æ­£ææ¡ˆ

**stopæ¡ä»¶**: Criticalä¸æ•´åˆ > 0ä»¶ã§åœæ­¢

---

## Phase 3: ãƒ†ã‚¹ãƒˆï¼ˆTestingï¼‰

### 3.1 ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: `qa-unit`
**ä¾å­˜**: å®Ÿè£…å®Œäº†å¾Œ

```bash
# ä¸¦åˆ—å®Ÿè¡Œ
Task:qa-unit(prompt: "get_user_roleé–¢æ•°ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä½œæˆ")
Task:qa-unit(prompt: "RoleBadgeã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆä½œæˆ")
```

**ç›®æ¨™**: ã‚«ãƒãƒ¬ãƒƒã‚¸100%ï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼‰

**stopæ¡ä»¶**: ã‚«ãƒãƒ¬ãƒƒã‚¸ < 90%ã§è­¦å‘Š

### 3.2 çµ±åˆãƒ†ã‚¹ãƒˆ

**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: `qa-integration`
**ä¾å­˜**: `qa-unit`å®Œäº†å¾Œ

```bash
Task:qa-integration(prompt: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«APIçµ±åˆãƒ†ã‚¹ãƒˆä½œæˆ")
```

**ãƒ†ã‚¹ãƒˆç¯„å›²**: FE â†’ API â†’ DB ã®ä¸€é€£ã®ãƒ•ãƒ­ãƒ¼

**stopæ¡ä»¶**: çµ±åˆãƒ†ã‚¹ãƒˆå¤±æ•— > 0ä»¶ã§åœæ­¢

### 3.3 E2Eãƒ†ã‚¹ãƒˆ

**ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚³ãƒãƒ³ãƒ‰**: `/e2e-full`
**ä¾å­˜**: `qa-integration`å®Œäº†å¾Œ

```bash
/e2e-full
```

**ãƒ†ã‚¹ãƒˆç¯„å›²**: ãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œå«ã‚€å…¨ä½“ãƒ•ãƒ­ãƒ¼

**stopæ¡ä»¶**: E2Eå¤±æ•— > 5ä»¶ã§åœæ­¢

---

## Phase 4: å“è³ªä¿è¨¼ï¼ˆQuality Assuranceï¼‰

### 4.1 Lint/ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: `lint-fix`
**ä¾å­˜**: å…¨å®Ÿè£…å®Œäº†å¾Œ

```bash
Task:lint-fix(prompt: "å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«ã®Lintä¿®æ­£ã¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ")
```

**å¯¾è±¡**: `git diff --name-only`ã®å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿

### 4.2 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³

**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: `sec-scan`
**ä¾å­˜**: `lint-fix`å®Œäº†å¾Œ

```bash
Task:sec-scan(prompt: "æ–°æ©Ÿèƒ½ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³å®Ÿè¡Œ")
```

**stopæ¡ä»¶**: Criticalè„†å¼±æ€§ > 0ä»¶ã§åœæ­¢

---

## Phase 5: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°ï¼ˆDocumentationï¼‰

### 5.1 Serenaãƒ¡ãƒ¢ãƒªæ›´æ–°

```bash
mcp__serena__write_memory(
  memory_name: "project/session{ç•ªå·}_user_role_feature.md",
  content: "# Session {ç•ªå·} å®Œäº†å ±å‘Š..."
)
```

### 5.2 å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°

**ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚³ãƒãƒ³ãƒ‰**: `/docs-sync`

```bash
/docs-sync
```

**æ›´æ–°å¯¾è±¡**:
- `docs/api/API.md`
- `docs/database/DATABASE.md`
- `next_session_prompt.md`

---

## Phase 6: ãƒªãƒªãƒ¼ã‚¹ï¼ˆReleaseï¼‰

### 6.1 Git Commit & PRä½œæˆ

```bash
git checkout -b feat-user-role
git add .
git commit -m "feat: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ç®¡ç†æ©Ÿèƒ½è¿½åŠ 

- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIå®Ÿè£…
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰UIå®Ÿè£…
- ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆãƒ»çµ±åˆãƒ†ã‚¹ãƒˆãƒ»E2Eãƒ†ã‚¹ãƒˆè¿½åŠ 

ğŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"

mcp__github__create_pull_request(
  owner: "ShigaRyunosuke10",
  repo: "nissei",
  title: "feat: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ç®¡ç†æ©Ÿèƒ½è¿½åŠ ",
  body: "## Summary\n- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ç®¡ç†æ©Ÿèƒ½è¿½åŠ \n\n## Test\n- [x] Unit Test (100%)\n- [x] Integration Test\n- [x] E2E Test",
  head: "feat-user-role",
  base: "main"
)
```

### 6.2 PRæ‰¿èªãƒ»ãƒãƒ¼ã‚¸

```bash
# PRãƒ¬ãƒ“ãƒ¥ãƒ¼å¾Œ
mcp__github__merge_pull_request(
  owner: "ShigaRyunosuke10",
  repo: "nissei",
  pullNumber: {PRç•ªå·},
  merge_method: "squash"
)
```

---

## ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ—

```
plannerï¼ˆçµ±åˆï¼‰
  â†“
  â”œâ”€ impl-dev-backend â†’ qa-unit â†’ qa-integration
  â”‚                                    â†“
  â””â”€ impl-dev-frontend â†’ qa-unit â”€â”€â”€â”€â”€â”€â”¤
                                       â†“
                                code-reviewerï¼ˆFE/BEæ•´åˆæ€§ï¼‰
                                       â†“
                                   /e2e-full
                                       â†“
                                   lint-fix
                                       â†“
                                   sec-scan
                                       â†“
                                   /docs-sync
                                       â†“
                                   Git Commit & PR
```

---

## æ¨å®šæ‰€è¦æ™‚é–“

- Phase 1: 30-60åˆ†
- Phase 2: 2-4æ™‚é–“
- Phase 3: 1-2æ™‚é–“
- Phase 4: 30åˆ†
- Phase 5: 30åˆ†
- Phase 6: 30åˆ†

**åˆè¨ˆ**: 5-8æ™‚é–“ï¼ˆä¸­è¦æ¨¡æ©Ÿèƒ½è¿½åŠ ï¼‰

---

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. **è¨ˆç”»ãƒ•ã‚§ãƒ¼ã‚ºã‚’çœç•¥ã—ãªã„**: æ‰‹æˆ»ã‚Šé˜²æ­¢ã®ãŸã‚å¿…é ˆ
2. **ä¾å­˜é–¢ä¿‚ã‚’å®ˆã‚‹**: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIå®Œæˆå¾Œã«ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…
3. **stopæ¡ä»¶ã‚’å°Šé‡**: ãƒ†ã‚¹ãƒˆå¤±æ•—æ™‚ã¯ä¿®æ­£ã‚’å„ªå…ˆ
4. **ä¸¦åˆ—å®Ÿè¡Œå¯èƒ½ãªç®‡æ‰€**: ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼ˆFE/BEåŒæ™‚ï¼‰
5. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒæœŸã‚’å¿˜ã‚Œãªã„**: PRãƒãƒ¼ã‚¸å‰ã«å¿…ãšå®Ÿè¡Œ
